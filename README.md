This thing is a complete mess and I had only the faintest faculty with web development when I threw this together some years ago (that one multi-tier programming class I had to take only barely touched on anything at all like this, sadly). It would have taken me more time than I had available to actually finish something this complicated.

SQLAlchemy, Flask, and WTForms handle the bulk of what's here. Flask takes care of CSRF protection straight out of the box, as I implemented in __init__.py, and SQL injection protection is provided by my use of parameterized SQLAlchemy commands. SQLAlchemy strips out anything that could be mistaken for SQL commands when parameterized commands are used. XSS is partly prevented; all but one of the forms that I developed sanitize all input to prevent the injection of scripting or commands. The sole exception is the content block for posts themselves; I wasn't able to think of a good solution for that, given that ideally users could be trying to post almost anything at all, including code snippets for completely innocuous purposes.
